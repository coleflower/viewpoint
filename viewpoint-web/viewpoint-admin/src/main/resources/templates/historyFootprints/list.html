<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>历史足迹列表</title>
		<meta name="Description" content="基于layUI数据表格操作"/>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" th:href="@{/css/font.css}">
		<link rel="stylesheet" th:href="@{/css/weadmin.css}">
	</head>

	<body>
		<div class="weadmin-nav">
			<span class="layui-breadcrumb">
				<a href="">首页</a>
				<a href="">历史足迹管理</a>
				<a>
				  <cite>历史足迹列表</cite>
				</a>
			  </span>
			<a class="layui-btn layui-btn-sm" style="line-height:1.6em;margin-top:3px;float:right" href="javascript:location.replace(location.href);" title="刷新">
				<i class="layui-icon" style="line-height:30px">&#x1002;</i></a>
		</div>
		<div class="weadmin-body">
			<div class="weadmin-block demoTable">
				<button class="layui-btn" th:onclick="|javascript:WeAdminShow('添加历史足迹','@{/historyFootprints/add}')|"  onclick="WeAdminShow('添加历史足迹','/historyFootprints/add')"><i class="layui-icon">&#xe61f;</i>添加足迹</button>
				<!--<button class="layui-btn" id="orderByStartYear"><i class="layui-icon">&#xe625;</i>历史时间排序(默认)</button>-->
				<!--<button class="layui-btn" id="orderBySort"><i class="layui-icon">&#xe625;</i>序号排序</button>-->
			</div>

			<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
				<legend>文庙大事记</legend>
			</fieldset>
			<!--<i class="layui-icon layui-timeline-axis"></i>-->
			<ul class="layui-timeline" >
				<li class="layui-timeline-item" th:each="footprints : ${historyFootprintsList}">
					<i class="layui-icon layui-timeline-axis"></i>
					<div class="layui-timeline-content layui-text">
						<div class="class1" ><button id="deleteFootprints" th:value="${footprints.historyId}" class="layui-btn layui-btn-xs"><i class="layui-icon"></i>删除</button></div>
						<a><div class="layui-timeline-title" th:onclick="|javascript:WeAdminShow('添加历史足迹','/historyFootprints/add?historyId=${footprints.historyId}')|" th:value="${footprints.historyId}" th:text="${footprints.historyContent}"></div>
						</a>
					</div>
				</li>
			</ul>

			<script type="text/javascript" th:src="@{/layui/layui.js}"></script>

		</div>
	</body>
	<style>
		.class1{display:inline;}
		.layui-timeline-title{display:inline;}
	</style>
	<script th:inline="javascript">

        /*<![CDATA[*/
        var basePath = /*[[@{/}]]*/;
        /*]]>*/

        layui.extend({
            admin: basePath+'js/admin'
        });
        layui.use(['table', 'jquery','form', 'admin'], function() {
            var table = layui.table,
                $ = layui.jquery,
                form = layui.form,
                admin = layui.admin;


            // $(document).on('click','#orderBySort',function(){
            //     window.location.href = "http://localhost:8080/historyFootprints/index?orderBy=1";
            // });
            //
            // $(document).on('click','#orderByStartYear',function(){
            //     window.location.href = "http://localhost:8080/historyFootprints/index";
            // });

            $(document).on('click','#deleteFootprints',function(){
                layer.confirm("确认要删除吗，删除后不能恢复", { title: "删除确认" },
                    function (index) {
                        layer.close(index);
                        $.ajax({
                            url : basePath+'historyFootprints/delete',
                            dataType : 'json',
                            data :{'historyId':$("#deleteFootprints").val()},
                            success : function(data) {
                                if (data.code == 0) {
                                    layer.alert('删除成功', {
                                        icon: 1,
                                        skin: 'layer-ext-moon',
                                        title: "删除操作",
                                        btn: ['确定']
                                    },function (index, item) {
                                        location.reload();
                                    });
                                } else{
                                    layer.alert('删除失败', {
                                            icon: 2,
                                            skin: 'layer-ext-moon',
                                        title: "删除操作",
										btn: ['确定']
                                    },
                                    function (index, item) {
                                         ocation.reload();
                                    });
                                }
                            }
                        });
                    })
            });
        });
	</script>
</html>